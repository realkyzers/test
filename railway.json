{
  "$schema": "https://railway.app/railway.schema.json",
  "services": {
    "backend": {
      "source": {
        "path": "dashboard/backend"
      },
      "build": {
        "builder": "DOCKERFILE"
      },
      "deploy": {
        "startCommand": "npm start",
        "restartPolicyType": "on_failure",
        "restartPolicyMaxRetries": 5
      },
      "environment": {
        "NODE_ENV": "production",
        "PORT": "5000",
        "FRONTEND_URL": "${RAILWAY_FRONTEND_URL}",
        "MONGODB_URI": "${RAILWAY_MONGODB_URL}",
        "MYSQLHOST": "${RAILWAY_MYSQLHOST}",
        "MYSQLPORT": "${RAILWAY_MYSQLPORT}",
        "MYSQLUSER": "${RAILWAY_MYSQLUSER}",
        "MYSQLPASSWORD": "${RAILWAY_MYSQLPASSWORD}",
        "MYSQLDATABASE": "${RAILWAY_MYSQLDATABASE}",
        "DISCORD_CLIENT_ID": "${DISCORD_CLIENT_ID}",
        "DISCORD_CLIENT_SECRET": "${DISCORD_CLIENT_SECRET}",
        "DISCORD_REDIRECT_URI": "${RAILWAY_BACKEND_URL}/api/auth/discord/callback",
        "JWT_SECRET": "${JWT_SECRET}",
        "BOT_API_URL": "${BOT_API_URL}"
      }
    },
    "frontend": {
      "source": {
        "path": "dashboard/frontend"
      },
      "build": {
        "builder": "DOCKERFILE"
      },
      "deploy": {
        "startCommand": "nginx -g daemon off;",
        "restartPolicyType": "on_failure",
        "restartPolicyMaxRetries": 5
      },
      "environment": {
        "REACT_APP_API_URL": "${RAILWAY_BACKEND_URL}",
        "REACT_APP_SOCKET_URL": "${RAILWAY_BACKEND_URL}"
      }
    },
    "mongodb": {
      "source": {
        "image": "mongo:latest"
      }
    },
    "mysql": {
      "source": {
        "image": "mysql:8"
      },
      "environment": {
        "MYSQL_ROOT_PASSWORD": "${MYSQL_ROOT_PASSWORD}",
        "MYSQL_DATABASE": "blackhawks"
      }
    }
  }
}
